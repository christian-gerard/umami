{"ast":null,"code":"import{useContext,useState}from\"react\";import{UserContext}from\"../context/UserContext\";import{useNavigate}from\"react-router-dom\";import toast from\"react-hot-toast\";import*as Yup from\"yup\";import{object,string}from\"yup\";import{Formik,Form,Field,useFormik}from\"formik\";// // // // // Signup\nimport{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const signupSchema=object({username:string().min(3,\"Username must be at least 3 characters long.\").max(20,\"Username must be 20 characters or less.\").required(\"Username is required.\"),email:string(),password_hash:string().min(8,\"Password must be at least 8 characters long.\").matches(/[a-zA-Z0-9]/,\"Password should contain letters and numbers.\"),// .minLowercase(1, 'Password must contain at least 1 lowercase letter.')\n// .minUppercase(1, 'Password must contain at least 1 uppercase letter.')\n// .minNumbers(1, 'Password must contain at least 1 number.'),\n// .minSymbols(1, 'Password must contain at least 1 special character.')\n// .required('Password is required.'),\nconfirmPassword:string().oneOf([Yup.ref(\"password_hash\"),null],\"Passwords must match.\").required(\"Confirm Password is required.\")});// // // // // Login\nconst loginSchema=object({username:string().required(\"Username is required.\"),// Add additional password requirements\npassword_hash:string()});// // // // // Initial Values\nconst initialValues={username:\"\",email:\"\",password_hash:\"\",confirmPassword:\"\",role:1};function Auth(){const{login}=useContext(UserContext);const[isLogin,setIsLogin]=useState(true);const navigate=useNavigate();const requestUrl=isLogin?\"/login\":\"/signup\";const formik=useFormik({initialValues,validationSchema:isLogin?loginSchema:signupSchema,onSubmit:formData=>{fetch(requestUrl,{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(formData)}).then(res=>{if(res.ok){res.json().then(userData=>{login(userData);}).then(()=>{isLogin?navigate(\"/cookbook\"):navigate(\"/cookbook\");toast.success(\"Logged in\");});}else if(res.status===422){toast.error(\"Invalid Login\");}else{return res.json().then(errorObj=>toast.error(errorObj.Error));}});}});return/*#__PURE__*/_jsx(\"div\",{className:\"flex flex-col justify-center items-center h-screen  \",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-shittake p-6 text-white rounded-xl\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-6xl flex justify-center tracking-[0.25em] p-6\",children:\"UMAMI\"}),/*#__PURE__*/_jsx(\"h2\",{className:\"text-3xl\",children:isLogin?\"Login\":\"Sign Up\"}),/*#__PURE__*/_jsx(Formik,{onSubmit:formik.handleSubmit,children:/*#__PURE__*/_jsxs(Form,{className:\"flex justify-center flex-col p-1\",onSubmit:formik.handleSubmit,children:[/*#__PURE__*/_jsx(Field,{type:\"text\",name:\"username\",placeholder:\"Username\",onChange:formik.handleChange,onBlur:formik.handleBlur,value:formik.values.username,className:\"m-2 p-2 text-black rounded-lg\",autoComplete:\"username\"}),formik.errors.username&&formik.touched.username&&/*#__PURE__*/_jsx(\"div\",{className:\"\",children:formik.errors.username}),/*#__PURE__*/_jsx(Field,{type:\"password\",name:\"password_hash\",placeholder:\"Password\",onChange:formik.handleChange,onBlur:formik.handleBlur,value:formik.values.password_hash,className:\"m-2 p-2 text-black rounded-lg\",autoComplete:\"current-password\"}),formik.errors.password_hash&&formik.touched.password_hash&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message show\",children:formik.errors.password_hash}),!isLogin&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Field,{type:\"password\",name:\"confirmPassword\",placeholder:\"Confirm Password\",onChange:formik.handleChange,onBlur:formik.handleBlur,value:formik.values.confirmPassword,className:\"m-2 text-black\"}),formik.errors.confirmPassword&&formik.touched.confirmPassword&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message show\",children:formik.errors.confirmPassword}),/*#__PURE__*/_jsx(Field,{type:\"email\",name:\"email\",placeholder:\"Email\",onChange:formik.handleChange,onBlur:formik.handleBlur,value:formik.values.email,className:\"m-2 text-black\"}),formik.errors.email&&formik.touched.email&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message show\",children:formik.errors.email})]}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",className:\"bg-champagne text-black text-lg p-1 m-1 rounded-lg\",value:isLogin?\"Login\":\"Sign up\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"text-lg text-blue-200\",onClick:()=>setIsLogin(!isLogin),children:isLogin?\"Create New Account\":\"Login to Account\"})]})})]})});}export default Auth;","map":{"version":3,"names":["useContext","useState","UserContext","useNavigate","toast","Yup","object","string","Formik","Form","Field","useFormik","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","signupSchema","username","min","max","required","email","password_hash","matches","confirmPassword","oneOf","ref","loginSchema","initialValues","role","Auth","login","isLogin","setIsLogin","navigate","requestUrl","formik","validationSchema","onSubmit","formData","fetch","method","headers","body","JSON","stringify","then","res","ok","json","userData","success","status","error","errorObj","Error","className","children","handleSubmit","type","name","placeholder","onChange","handleChange","onBlur","handleBlur","value","values","autoComplete","errors","touched","onClick"],"sources":["/Users/christiangerard/Development/code/capstone/umami/client/src/components/Auth.js"],"sourcesContent":["import { useContext, useState } from \"react\";\nimport { UserContext } from \"../context/UserContext\";\nimport { useNavigate } from \"react-router-dom\";\nimport toast from \"react-hot-toast\";\nimport * as Yup from \"yup\";\nimport { object, string } from \"yup\";\nimport { Formik, Form, Field, useFormik } from \"formik\";\n\n// // // // // Signup\nconst signupSchema = object({\n  username: string()\n    .min(3, \"Username must be at least 3 characters long.\")\n    .max(20, \"Username must be 20 characters or less.\")\n    .required(\"Username is required.\"),\n\n  email: string(),\n\n  password_hash: string()\n    .min(8, \"Password must be at least 8 characters long.\")\n    .matches(/[a-zA-Z0-9]/, \"Password should contain letters and numbers.\"),\n  // .minLowercase(1, 'Password must contain at least 1 lowercase letter.')\n  // .minUppercase(1, 'Password must contain at least 1 uppercase letter.')\n  // .minNumbers(1, 'Password must contain at least 1 number.'),\n  // .minSymbols(1, 'Password must contain at least 1 special character.')\n  // .required('Password is required.'),\n\n  confirmPassword: string()\n    .oneOf([Yup.ref(\"password_hash\"), null], \"Passwords must match.\")\n    .required(\"Confirm Password is required.\"),\n});\n\n// // // // // Login\nconst loginSchema = object({\n  username: string().required(\"Username is required.\"),\n  // Add additional password requirements\n  password_hash: string(),\n});\n\n// // // // // Initial Values\nconst initialValues = {\n  username: \"\",\n  email: \"\",\n  password_hash: \"\",\n  confirmPassword: \"\",\n  role: 1,\n};\n\nfunction Auth() {\n  const { login } = useContext(UserContext);\n  const [isLogin, setIsLogin] = useState(true);\n  const navigate = useNavigate();\n  const requestUrl = isLogin ? \"/login\" : \"/signup\";\n  const formik = useFormik({\n    initialValues,\n    validationSchema: isLogin ? loginSchema : signupSchema,\n    onSubmit: (formData) => {\n      fetch(requestUrl, {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(formData),\n      }).then((res) => {\n        if (res.ok) {\n          res\n            .json()\n            .then((userData) => {\n              login(userData);\n            })\n            .then(() => {\n              isLogin ? navigate(\"/cookbook\") : navigate(\"/cookbook\");\n              toast.success(\"Logged in\");\n            });\n        } else if (res.status === 422) {\n          toast.error(\"Invalid Login\");\n        } else {\n          return res.json().then((errorObj) => toast.error(errorObj.Error));\n        }\n      });\n    },\n  });\n\n  return (\n    <div className=\"flex flex-col justify-center items-center h-screen  \">\n      <div className=\"bg-shittake p-6 text-white rounded-xl\">\n        <h1 className=\"text-6xl flex justify-center tracking-[0.25em] p-6\">\n          UMAMI\n        </h1>\n        <h2 className=\"text-3xl\">{isLogin ? \"Login\" : \"Sign Up\"}</h2>\n        <Formik onSubmit={formik.handleSubmit}>\n          <Form\n            className=\"flex justify-center flex-col p-1\"\n            onSubmit={formik.handleSubmit}\n          >\n            <Field\n              type=\"text\"\n              name=\"username\"\n              placeholder=\"Username\"\n              onChange={formik.handleChange}\n              onBlur={formik.handleBlur}\n              value={formik.values.username}\n              className=\"m-2 p-2 text-black rounded-lg\"\n              autoComplete=\"username\"\n            />\n            {formik.errors.username && formik.touched.username && (\n              <div className=\"\">{formik.errors.username}</div>\n            )}\n\n            <Field\n              type=\"password\"\n              name=\"password_hash\"\n              placeholder=\"Password\"\n              onChange={formik.handleChange}\n              onBlur={formik.handleBlur}\n              value={formik.values.password_hash}\n              className=\"m-2 p-2 text-black rounded-lg\"\n              autoComplete=\"current-password\"\n            />\n            {formik.errors.password_hash && formik.touched.password_hash && (\n              <div className=\"error-message show\">\n                {formik.errors.password_hash}\n              </div>\n            )}\n            {!isLogin && (\n              <>\n                <Field\n                  type=\"password\"\n                  name=\"confirmPassword\"\n                  placeholder=\"Confirm Password\"\n                  onChange={formik.handleChange}\n                  onBlur={formik.handleBlur}\n                  value={formik.values.confirmPassword}\n                  className=\"m-2 text-black\"\n                />\n                {formik.errors.confirmPassword &&\n                  formik.touched.confirmPassword && (\n                    <div className=\"error-message show\">\n                      {formik.errors.confirmPassword}\n                    </div>\n                  )}\n                <Field\n                  type=\"email\"\n                  name=\"email\"\n                  placeholder=\"Email\"\n                  onChange={formik.handleChange}\n                  onBlur={formik.handleBlur}\n                  value={formik.values.email}\n                  className=\"m-2 text-black\"\n                />\n                {formik.errors.email && formik.touched.email && (\n                  <div className=\"error-message show\">\n                    {formik.errors.email}\n                  </div>\n                )}\n              </>\n            )}\n            <input\n              type=\"submit\"\n              className=\"bg-champagne text-black text-lg p-1 m-1 rounded-lg\"\n              value={isLogin ? \"Login\" : \"Sign up\"}\n            />\n\n            <button\n              type=\"button\"\n              className=\"text-lg text-blue-200\"\n              onClick={() => setIsLogin(!isLogin)}\n            >\n              {isLogin ? \"Create New Account\" : \"Login to Account\"}\n            </button>\n          </Form>\n        </Formik>\n      </div>\n    </div>\n  );\n}\n\nexport default Auth;\n"],"mappings":"AAAA,OAASA,UAAU,CAAEC,QAAQ,KAAQ,OAAO,CAC5C,OAASC,WAAW,KAAQ,wBAAwB,CACpD,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,MAAO,CAAAC,KAAK,KAAM,iBAAiB,CACnC,MAAO,GAAK,CAAAC,GAAG,KAAM,KAAK,CAC1B,OAASC,MAAM,CAAEC,MAAM,KAAQ,KAAK,CACpC,OAASC,MAAM,CAAEC,IAAI,CAAEC,KAAK,CAAEC,SAAS,KAAQ,QAAQ,CAEvD;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,QAAA,IAAAC,SAAA,CAAAC,IAAA,IAAAC,KAAA,yBACA,KAAM,CAAAC,YAAY,CAAGZ,MAAM,CAAC,CAC1Ba,QAAQ,CAAEZ,MAAM,CAAC,CAAC,CACfa,GAAG,CAAC,CAAC,CAAE,8CAA8C,CAAC,CACtDC,GAAG,CAAC,EAAE,CAAE,yCAAyC,CAAC,CAClDC,QAAQ,CAAC,uBAAuB,CAAC,CAEpCC,KAAK,CAAEhB,MAAM,CAAC,CAAC,CAEfiB,aAAa,CAAEjB,MAAM,CAAC,CAAC,CACpBa,GAAG,CAAC,CAAC,CAAE,8CAA8C,CAAC,CACtDK,OAAO,CAAC,aAAa,CAAE,8CAA8C,CAAC,CACzE;AACA;AACA;AACA;AACA;AAEAC,eAAe,CAAEnB,MAAM,CAAC,CAAC,CACtBoB,KAAK,CAAC,CAACtB,GAAG,CAACuB,GAAG,CAAC,eAAe,CAAC,CAAE,IAAI,CAAC,CAAE,uBAAuB,CAAC,CAChEN,QAAQ,CAAC,+BAA+B,CAC7C,CAAC,CAAC,CAEF;AACA,KAAM,CAAAO,WAAW,CAAGvB,MAAM,CAAC,CACzBa,QAAQ,CAAEZ,MAAM,CAAC,CAAC,CAACe,QAAQ,CAAC,uBAAuB,CAAC,CACpD;AACAE,aAAa,CAAEjB,MAAM,CAAC,CACxB,CAAC,CAAC,CAEF;AACA,KAAM,CAAAuB,aAAa,CAAG,CACpBX,QAAQ,CAAE,EAAE,CACZI,KAAK,CAAE,EAAE,CACTC,aAAa,CAAE,EAAE,CACjBE,eAAe,CAAE,EAAE,CACnBK,IAAI,CAAE,CACR,CAAC,CAED,QAAS,CAAAC,IAAIA,CAAA,CAAG,CACd,KAAM,CAAEC,KAAM,CAAC,CAAGjC,UAAU,CAACE,WAAW,CAAC,CACzC,KAAM,CAACgC,OAAO,CAAEC,UAAU,CAAC,CAAGlC,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAAAmC,QAAQ,CAAGjC,WAAW,CAAC,CAAC,CAC9B,KAAM,CAAAkC,UAAU,CAAGH,OAAO,CAAG,QAAQ,CAAG,SAAS,CACjD,KAAM,CAAAI,MAAM,CAAG3B,SAAS,CAAC,CACvBmB,aAAa,CACbS,gBAAgB,CAAEL,OAAO,CAAGL,WAAW,CAAGX,YAAY,CACtDsB,QAAQ,CAAGC,QAAQ,EAAK,CACtBC,KAAK,CAACL,UAAU,CAAE,CAChBM,MAAM,CAAE,MAAM,CACdC,OAAO,CAAE,CACP,cAAc,CAAE,kBAClB,CAAC,CACDC,IAAI,CAAEC,IAAI,CAACC,SAAS,CAACN,QAAQ,CAC/B,CAAC,CAAC,CAACO,IAAI,CAAEC,GAAG,EAAK,CACf,GAAIA,GAAG,CAACC,EAAE,CAAE,CACVD,GAAG,CACAE,IAAI,CAAC,CAAC,CACNH,IAAI,CAAEI,QAAQ,EAAK,CAClBnB,KAAK,CAACmB,QAAQ,CAAC,CACjB,CAAC,CAAC,CACDJ,IAAI,CAAC,IAAM,CACVd,OAAO,CAAGE,QAAQ,CAAC,WAAW,CAAC,CAAGA,QAAQ,CAAC,WAAW,CAAC,CACvDhC,KAAK,CAACiD,OAAO,CAAC,WAAW,CAAC,CAC5B,CAAC,CAAC,CACN,CAAC,IAAM,IAAIJ,GAAG,CAACK,MAAM,GAAK,GAAG,CAAE,CAC7BlD,KAAK,CAACmD,KAAK,CAAC,eAAe,CAAC,CAC9B,CAAC,IAAM,CACL,MAAO,CAAAN,GAAG,CAACE,IAAI,CAAC,CAAC,CAACH,IAAI,CAAEQ,QAAQ,EAAKpD,KAAK,CAACmD,KAAK,CAACC,QAAQ,CAACC,KAAK,CAAC,CAAC,CACnE,CACF,CAAC,CAAC,CACJ,CACF,CAAC,CAAC,CAEF,mBACE5C,IAAA,QAAK6C,SAAS,CAAC,sDAAsD,CAAAC,QAAA,cACnE1C,KAAA,QAAKyC,SAAS,CAAC,uCAAuC,CAAAC,QAAA,eACpD9C,IAAA,OAAI6C,SAAS,CAAC,oDAAoD,CAAAC,QAAA,CAAC,OAEnE,CAAI,CAAC,cACL9C,IAAA,OAAI6C,SAAS,CAAC,UAAU,CAAAC,QAAA,CAAEzB,OAAO,CAAG,OAAO,CAAG,SAAS,CAAK,CAAC,cAC7DrB,IAAA,CAACL,MAAM,EAACgC,QAAQ,CAAEF,MAAM,CAACsB,YAAa,CAAAD,QAAA,cACpC1C,KAAA,CAACR,IAAI,EACHiD,SAAS,CAAC,kCAAkC,CAC5ClB,QAAQ,CAAEF,MAAM,CAACsB,YAAa,CAAAD,QAAA,eAE9B9C,IAAA,CAACH,KAAK,EACJmD,IAAI,CAAC,MAAM,CACXC,IAAI,CAAC,UAAU,CACfC,WAAW,CAAC,UAAU,CACtBC,QAAQ,CAAE1B,MAAM,CAAC2B,YAAa,CAC9BC,MAAM,CAAE5B,MAAM,CAAC6B,UAAW,CAC1BC,KAAK,CAAE9B,MAAM,CAAC+B,MAAM,CAAClD,QAAS,CAC9BuC,SAAS,CAAC,+BAA+B,CACzCY,YAAY,CAAC,UAAU,CACxB,CAAC,CACDhC,MAAM,CAACiC,MAAM,CAACpD,QAAQ,EAAImB,MAAM,CAACkC,OAAO,CAACrD,QAAQ,eAChDN,IAAA,QAAK6C,SAAS,CAAC,EAAE,CAAAC,QAAA,CAAErB,MAAM,CAACiC,MAAM,CAACpD,QAAQ,CAAM,CAChD,cAEDN,IAAA,CAACH,KAAK,EACJmD,IAAI,CAAC,UAAU,CACfC,IAAI,CAAC,eAAe,CACpBC,WAAW,CAAC,UAAU,CACtBC,QAAQ,CAAE1B,MAAM,CAAC2B,YAAa,CAC9BC,MAAM,CAAE5B,MAAM,CAAC6B,UAAW,CAC1BC,KAAK,CAAE9B,MAAM,CAAC+B,MAAM,CAAC7C,aAAc,CACnCkC,SAAS,CAAC,+BAA+B,CACzCY,YAAY,CAAC,kBAAkB,CAChC,CAAC,CACDhC,MAAM,CAACiC,MAAM,CAAC/C,aAAa,EAAIc,MAAM,CAACkC,OAAO,CAAChD,aAAa,eAC1DX,IAAA,QAAK6C,SAAS,CAAC,oBAAoB,CAAAC,QAAA,CAChCrB,MAAM,CAACiC,MAAM,CAAC/C,aAAa,CACzB,CACN,CACA,CAACU,OAAO,eACPjB,KAAA,CAAAF,SAAA,EAAA4C,QAAA,eACE9C,IAAA,CAACH,KAAK,EACJmD,IAAI,CAAC,UAAU,CACfC,IAAI,CAAC,iBAAiB,CACtBC,WAAW,CAAC,kBAAkB,CAC9BC,QAAQ,CAAE1B,MAAM,CAAC2B,YAAa,CAC9BC,MAAM,CAAE5B,MAAM,CAAC6B,UAAW,CAC1BC,KAAK,CAAE9B,MAAM,CAAC+B,MAAM,CAAC3C,eAAgB,CACrCgC,SAAS,CAAC,gBAAgB,CAC3B,CAAC,CACDpB,MAAM,CAACiC,MAAM,CAAC7C,eAAe,EAC5BY,MAAM,CAACkC,OAAO,CAAC9C,eAAe,eAC5Bb,IAAA,QAAK6C,SAAS,CAAC,oBAAoB,CAAAC,QAAA,CAChCrB,MAAM,CAACiC,MAAM,CAAC7C,eAAe,CAC3B,CACN,cACHb,IAAA,CAACH,KAAK,EACJmD,IAAI,CAAC,OAAO,CACZC,IAAI,CAAC,OAAO,CACZC,WAAW,CAAC,OAAO,CACnBC,QAAQ,CAAE1B,MAAM,CAAC2B,YAAa,CAC9BC,MAAM,CAAE5B,MAAM,CAAC6B,UAAW,CAC1BC,KAAK,CAAE9B,MAAM,CAAC+B,MAAM,CAAC9C,KAAM,CAC3BmC,SAAS,CAAC,gBAAgB,CAC3B,CAAC,CACDpB,MAAM,CAACiC,MAAM,CAAChD,KAAK,EAAIe,MAAM,CAACkC,OAAO,CAACjD,KAAK,eAC1CV,IAAA,QAAK6C,SAAS,CAAC,oBAAoB,CAAAC,QAAA,CAChCrB,MAAM,CAACiC,MAAM,CAAChD,KAAK,CACjB,CACN,EACD,CACH,cACDV,IAAA,UACEgD,IAAI,CAAC,QAAQ,CACbH,SAAS,CAAC,oDAAoD,CAC9DU,KAAK,CAAElC,OAAO,CAAG,OAAO,CAAG,SAAU,CACtC,CAAC,cAEFrB,IAAA,WACEgD,IAAI,CAAC,QAAQ,CACbH,SAAS,CAAC,uBAAuB,CACjCe,OAAO,CAAEA,CAAA,GAAMtC,UAAU,CAAC,CAACD,OAAO,CAAE,CAAAyB,QAAA,CAEnCzB,OAAO,CAAG,oBAAoB,CAAG,kBAAkB,CAC9C,CAAC,EACL,CAAC,CACD,CAAC,EACN,CAAC,CACH,CAAC,CAEV,CAEA,cAAe,CAAAF,IAAI","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}